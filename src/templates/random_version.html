{% extends "layout.html" %}
{% block content %}
<h2>Random UI Version (Cropping Test)</h2>

{% if feedback %}
  <div class="alert alert-info">{{ feedback }}</div>
  <a class="btn btn-primary" href="{{ url_for('quiz_bp.random_version') }}">Try Another Snippet</a>
{% else %}
  {% if song %}
    <!--
      Hardcoded crop container
      width=50, height=50, position relative, overflow hidden
    -->
    <div style="
      width:50px;
      height:50px;
      position:relative;
      overflow:hidden;
      border:1px solid #ccc;
      margin-bottom:1rem;
    ">

      <!--
        Big iframe: 600x600
        Hardcoded offsets & scale
      -->
      <iframe
        src="https://open.spotify.com/embed/track/{{ song.id }}?theme=0&view=coverart"
        width="600"
        height="600"
        frameborder="0"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
        style="
          position:absolute;
          top:-265px;
          left:-511px;
          transform: scale(1);
          transform-origin: top left;
        "
      ></iframe>
    </div>

    <!-- Single-field guess form -->
    {% set ctype = session.challenge_type %}
    <form method="POST" action="{{ url_for('quiz_bp.submit_guess') }}">
      {% if ctype == 'title' %}
        <p>Guess the <strong>Song Title</strong>:</p>
        <input type="text" name="guess" id="guess" class="form-control" placeholder="Song Title..." required>
      {% elif ctype == 'year' %}
        <p>Guess the <strong>Release Year</strong>:</p>
        <input type="text" name="guess" class="form-control" placeholder="Year (e.g. 1999)" required>
      {% else %}
        <p>Guess the <strong>Artist</strong>:</p>
        <input type="text" name="guess" id="guess" class="form-control" placeholder="Artist name..." required>
      {% endif %}
      <input type="hidden" name="source_page" value="random">
      <button class="btn btn-success mt-2">Submit Guess</button>
    </form>
  {% else %}
    <p><em>No track available.</em></p>
  {% endif %}
{% endif %}
{% endblock %}
